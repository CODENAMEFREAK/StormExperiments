package foss.freak.capture;



import java.io.IOException;
import java.util.ArrayList;
import java.util.List;

import org.jnetpcap.Pcap;
import org.jnetpcap.PcapIf;

import jpcap.*;
import jpcap.packet.Packet;


public class PacketCapturer {
	
	public static void main(String args[]) throws IOException
	{
		
		NetworkInterface device[] = JpcapCaptor.getDeviceList();
		for(NetworkInterface ifc: device)
			System.out.println(ifc.datalink_description);
		JpcapCaptor jpcap = JpcapCaptor.openDevice(device[0], 128, true, 1000);
		jpcap.loopPacket(-1, new PacketReceiver() {
			
			@Override
			public void receivePacket(Packet packet) {
			System.out.println(packet);	
				
			}
		});
		/*List<PcapIf> alldevs = new ArrayList<PcapIf>();
		System.out.println(Pcap.findAllDevs(alldevs, new StringBuilder()));*/
		
	}

}
